## 데이터 전처리

- 데이터 전처리 패키지는 전처리 작업에 필요한 함수들을 모아놓은 패키지 
- 패키지 유형 : plyr, dplyr, reshape2, data.table

### plyr

- 원본 데이터를 분석하기 쉬운 형태로 나눠서 다시 새로운 형태로 만들어 주는 패키지 
- 데이터 분할(split), 특정 함수 적용(apply), 재조합(combine)하여 반환 
- 패키지 함수는 **ply 형태 (data frame, list, array )
  - 첫 번째 입력, 두 번 째 출력 - adply 라면 array로 입력 받아 data frame으로 출력  



#### adply

```R
adply(iris, 1, function (row) {row$Sepal.Length >= 5.0 & row$Species == "setosa"})
```

![image](https://user-images.githubusercontent.com/81945553/142166705-922612ab-e1c5-4484-a1ee-55b298edd98e.png)

- adply함수를 통해 데이터 프레임의 각 행을 확인 (Length가 5이상이고, setosa)인지 확인하고 그 결과를 새로운 컬럼 V1(자동 생성)에 기록 - 조건을 만족하면 TRUE, 아니면 FALSE (이미지에는 setosa, V1 )



#### ddply

```R
ddply(iris, .(Species, Petal.Length<1.5), function(sub) {
data.frame(
+ mean_to=mean(sub$Sepal.Length), mean_so=mean(sub$Sepal.Width), 
+ mean_wo=mean(sub$Petal.Length), mean_jo= mean(sub$Sepal.Width)                         + )})
```

![image](https://user-images.githubusercontent.com/81945553/142167220-150cba30-a1c7-4d0f-9209-202f06aacdc1.png)

- Species와 Petal.Length가 1.5 미만인지의 여부로 데이터를 네 개의 변수로 그룹화하여 평균 출력 



#### transform

- 데이터 프레임에 새로운 변수를 추가할 수 있는 함수 
- transform(_data, tag1=value1, tag2=value2, ...)

```R
transform(iris, Total.w=Sepal.Width+Petal.Width)
```

![image](https://user-images.githubusercontent.com/81945553/142169663-1dfc0f80-a05b-4004-ba43-065c584a7cad.png)



### dpylr

- 데이터 전처리는 분석에 적합하도록 데이터를 가공하는 작업 
- 데이터 일부를 추출하거나, 종류별로 나누거나, 여러 데이터를 합치는 등의 데이터 가공 
- R에서 데이터 전처리 시 가장 많이 사용되는 패키지 
- %>% 는 ctrl + shift + m 단축키를 사용하면 편리하다. 

#### select

- 데이터에서 원하는 변수의 특정 열만 추출하는 함수 

![image](https://user-images.githubusercontent.com/81945553/142171203-d77af0aa-ce00-4edc-9765-d87c264b7c96.png)

#### filter

- 원하는 조건에 따라서 데이터를 필터링하고 추출 

![image](https://user-images.githubusercontent.com/81945553/142171493-826eea8a-dc6e-4654-bf9f-52cd0a20b18d.png)



#### mutate

- 기존 데이터에 파생변수를 만들어 추가할 수 있는 함수 
- 데이터 프레임 이름 %>% mutate(새로운 변수명=값) 

![image](https://user-images.githubusercontent.com/81945553/142172025-0e21209e-d19e-4cbe-8474-dbc4bd8ac4bf.png)

- filter 함수를 통해 virginica 데이터만 추출하고, mutate를 통해 꽃 받침 길이가 6보다 길면 L, 작거나 같으면 S를 범주로하는 파생변수 Len 생성 



#### group_by, summarise 

- group_by : 지정 변수를 기준으로 데이터 그룹화, summarise : 요약 통계치를 계산하는 함수 

![image](https://user-images.githubusercontent.com/81945553/142172453-374a91d7-decf-4cc3-a4fd-d6ebf08412c9.png)

- iris 데이터에 대해 품종을 기준으로 그룹화 한 뒤, 품종별 꽃잎 너비의 평균 출력 



#### arrange 

- 특정 열 기준으로 데이터 정렬해주는 함수 
- defalut : 오름차순, desc : 내림차순 

![image](https://user-images.githubusercontent.com/81945553/142172848-977f8964-af9e-4b0d-a100-d63b742acc4c.png)



#### inner_join

- 두 데이터 프레임에서 공통적으로 존재하는 모든 열을 병합 

![image](https://user-images.githubusercontent.com/81945553/142173269-51c7fc01-1114-4693-b2ad-1296761d0e6e.png)

![image](https://user-images.githubusercontent.com/81945553/142173592-4766bae4-5576-4d4d-a04a-ffe97767c1ea.png)

![image](https://user-images.githubusercontent.com/81945553/142173676-3d2f492e-3028-4a1f-9775-57378f92462e.png)

- Department를 기준으로 하여 X, Y에 공통적으로 존재하는 모든 열을 병합 